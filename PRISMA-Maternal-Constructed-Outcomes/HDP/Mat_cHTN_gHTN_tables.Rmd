---
title:  "<span style='font-size: 18px'> <span style='text-align: center'> PRISMA-Maternal-Outcomes (Hypertensive Disorders of Pregnancy) (Issued: `r Sys.Date()`)"
author: "Author: Fouzia Farooq"
output:
  html_document:
    df_print: paged
    toc: yes
    toc_depth: 4
 

---

&nbsp;
&nbsp;
&nbsp;
&nbsp;


##### **Includes data from synapse last updated:** {.unlisted .unnumbered}
#####  2023-10-13 {.unlisted .unnumbered}


```{css, echo=FALSE}
.table caption {
  color: black;
  font-weight: bold;
}
```


```{r, data setup, include = FALSE}

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
#
```

```{r}
library(knitr)
library(tidyverse)
library(reshape2)
library(lubridate)
library(kableExtra)
library(emo)
library(naniar)
library(dplyr)
library(RColorBrewer)
```

```{r}
# AMONG WOMEN WHO HAVE DELIVERED
htn_df2 <- read.csv('../data_out/mat_htn_tables_20231017.csv', header = TRUE)
df <- htn_df2 

missing_mnh08_df <- read.csv('../data_out/missing_mnh08_df_delivered_20231017.csv')
chtn_diag_df <- read.csv('../data_out/chtn_diag_df.csv', header=TRUE)
```
**Denominator used for analysis:**
Enrolled women who have a completed pregnancy
<br>
<br>
<br>

\newpage

### Total number of BP measurements across visits
```{r}

chtn_table <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    "6 BP measurements, n (%)" =
      paste0(sum(SUM_BP==6),
             " (",
             format(round(sum(SUM_BP==6)/n()*100, 2),nsmall=2, digits=3),
             ")"),
    
    "5 BP measurements, n (%)" =
      paste0(sum(SUM_BP==5),
             " (",
             format(round(sum(SUM_BP==5)/n()*100, 2),nsmall=2, digits=3),
             ")"),
    
    "4 BP measurements, n (%)" =
      paste0(sum(SUM_BP==4),
             " (",
             format(round(sum(SUM_BP==4)/n()*100, 2),nsmall=2, digits=3),
             ")"),
    
    "3 BP measurements, n (%)" =
      paste0(sum(SUM_BP==3),
             " (",
             format(round(sum(SUM_BP==3)/n()*100, 2),nsmall=2, digits=3),
             ")"),
    
    "2 BP measurements, n (%)" =
      paste0(sum(SUM_BP==2),
             " (",
             format(round(sum(SUM_BP==2)/n()*100, 2),nsmall=2, digits=3),
             ")"),
    
    "1 BP measurements, n (%)" =
      paste0(sum(SUM_BP==1),
             " (",
             format(round(sum(SUM_BP==1)/n()*100, 2),nsmall=2, digits=3),
             ")"),
    
    "0 BP measurements, n (%)" =
      paste0(sum(SUM_BP==0),
             " (",
             format(round(sum(SUM_BP==0)/n()*100, 2),nsmall=2, digits=3),
             ")")) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
```

#### **Table 1a. Total number of BP measurements across visits until delivery (from MNH06) (including the enrollment visit)**
```{r}
chtn_table  %>% 
  `rownames<-` (c(
    "6 BP measurements, n (%)",
    "5 BP measurements, n (%)",
    "4 BP measurements, n (%)",
    "3 BP measurements, n (%)",
    "2 BP measurements, n (%)",
    "1 BP measurements, n (%)",
    "0 BP measurements, n (%)")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position")) %>% 
  kable_styling(font_size = 14) %>%
  row_spec(0, extra_css = "border-bottom: 0px white;") %>%
  
  pack_rows("Blood Pressure measurements from VISIT 1-6, n (%)", 1, 7, label_row_css = "color: steelblue;")
```

\newpage

### Data missingness 

```{r}
# JUST LOOKING AT MISSINGNESS IN MNH08 ENROLLMENT
missing_mnh08_df2 <- missing_mnh08_df %>%   
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    # Missing MNH08 at enrollment among those who delivered and have passed their Enrollment visit window
    "Missing MNH08 at enrollment, n (%)" =
      paste0(sum(M08_MAT_VISIT_FORM_COMPLETED_1==0 & ENROLL_PASS==1, na.rm = TRUE),
             " (",
             format(round(sum(M08_MAT_VISIT_FORM_COMPLETED_1==0 & ENROLL_PASS==1, na.rm = TRUE)/(sum(ENROLL_PASS==1, na.rm=TRUE))*100, 2),nsmall=2, digits=3),
             ")"),
    
    # Missing MNH08 at ANC32 among those who delivered and have passed their ANC32 visit window
    "Missing MNH08 at ANC32 , n (%)" =
      paste0(sum(M08_MAT_VISIT_FORM_COMPLETED_3==0 & ANC32_PASS==1, na.rm = TRUE),
             " (",
             format(round(sum(M08_MAT_VISIT_FORM_COMPLETED_3==0 & ANC32_PASS==1, na.rm = TRUE)/(sum(ANC32_PASS==1, na.rm=TRUE))*100, 2),nsmall=2, digits=3),
             ")")) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
```

```{r}
# HAVE TO SET UP NO. MISSING AS FOLLOWS: MISSING PROTEINRUIA AMONG THOSE WHO HAVE A COMPLETED FORM DIVIVDED BY EVERYONE WITH A MISSING FORM

# Should this be setup over ANC32_PASS? b/c there are ppl who should have an MNH08 ANC32 but don't have it. 

other_missing <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    "Missing Proteinuria at <20 weeks' gestation (baseline), n (%)" =
      # MISSING PROTEINURIA AMONG THOSE WHO HAVE AN MNH08 FORM COMPLETED AT ENROLLMENT
      paste0(sum(is.na(PROTEINURIA_BASELINE) & M08_MAT_VISIT_FORM_COMPLETED_1==1, na.rm = TRUE),
             " (",
             format(round(sum(is.na(PROTEINURIA_BASELINE) &
                                M08_MAT_VISIT_FORM_COMPLETED_1==1, na.rm = TRUE)/(sum(M08_MAT_VISIT_FORM_COMPLETED_1==1, na.rm = TRUE))*100, 2),nsmall=2, digits=3),
             ")"),
    
    "Missing Proteinuria at >=20 weeks' gestation, n (%)" = 
       paste0(sum(is.na(PROTEINURIA_ANC_IPC)),
             " (",
             format(round(sum(is.na(PROTEINURIA_ANC_IPC))/n()*100, 2),nsmall=2, digits=3),
             ")"),
    
    "Missing Hb (CBC and POC) at ANC32, n (%)" =
      # MISSING Anemia at ANC-32 among those who have a completed ANC32 form (VISIT 4)
      paste0(sum(is.na(MAT_ANEMIA_MEAS4) & ANC32_PASS==1, na.rm = TRUE),
             " (",
             format(round(sum(is.na(MAT_ANEMIA_MEAS4) & 
                                ANC32_PASS==1, na.rm = TRUE)/(sum(ANC32_PASS==1, na.rm = TRUE))*100, 2),nsmall=2, digits=3),
             ")"),
    
    "Missing Bilirubin at ANC32, n (%)" =
      # MISSING Bilirubin at ANC-32 among those who have a completed ANC32 form (VISIT 4)
      paste0(sum(is.na(M08_IBILIRUBIN_LBORRES_4) & ANC32_PASS==1, na.rm = TRUE),
             " (",
             format(round(sum(is.na(M08_IBILIRUBIN_LBORRES_4) & 
                                ANC32_PASS==1, na.rm = TRUE)/(sum(ANC32_PASS==1, na.rm = TRUE))*100, 2),nsmall=2, digits=3),
             ")"),
    
    "Missing AST at ANC32, n (%)" =
      # MISSING AST at ANC-32 among those who have a completed ANC32 form (VISIT 4)
      paste0(sum(is.na(M08_AST_UL_LBORRES_4) & ANC32_PASS==1, na.rm = TRUE),
             " (",
             format(round(sum(is.na(M08_AST_UL_LBORRES_4) & 
                                ANC32_PASS==1, na.rm = TRUE)/(sum(ANC32_PASS==1, na.rm = TRUE))*100, 2),nsmall=2, digits=3),
             ")"),
    
    "Missing ALT at ANC32, n (%)" =
      # MISSING AST at ANC-32 among those who have a completed ANC32 form (VISIT 4)
      paste0(sum(is.na(M08_ALT_UL_LBORRES_4) & ANC32_PASS==1, na.rm = TRUE),
             " (",
             format(round(sum(is.na(M08_ALT_UL_LBORRES_4) & 
                                ANC32_PASS==1, na.rm = TRUE)/(sum(ANC32_PASS==1, na.rm = TRUE))*100, 2),nsmall=2, digits=3),
             ")"),
 #TODO Why is this more than 100%   
    "Missing PLATELETS at ANC32, n (%)" =
      # MISSING AST at ANC-32 among those who have a completed ANC32 form (VISIT 4)
      paste0(sum(is.na(M08_CBC_PLATE_LBORRES_4) & ANC32_PASS==1, na.rm = TRUE),
             " (",
             format(round(sum(is.na(M08_CBC_PLATE_LBORRES_4) &
                                ANC32_PASS==1, na.rm = TRUE)/(sum(ANC32_PASS==1, na.rm = TRUE))*100, 2),nsmall=2, digits=3),
             ")"),
    
    "Missing CREATININE at ANC32, n (%)" =
      # MISSING AST at ANC-32 among those who have a completed ANC32 form (VISIT 4)
      paste0(sum(is.na(M08_CREAT_UMOLL_LBORRES_4) & ANC32_PASS==1, na.rm = TRUE),
             " (",
             format(round(sum(is.na(M08_CREAT_UMOLL_LBORRES_4) & 
                                ANC32_PASS==1, na.rm = TRUE)/(sum(ANC32_PASS==1, na.rm = TRUE))*100, 2),nsmall=2, digits=3),
             ")")) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
    
```

```{r}
chtn_table <- rbind(missing_mnh08_df2, other_missing)
```

#### **Table 1b. Data Missingness (forms and variables)**
```{r}

# GHTN table rename: New Onset High BP after 20 weeks - dont exclude Proteinuria.
# CHTN:(High BP prior to 20 weeks)
# Table 1b. Missingness among variables for Preeclampsia

chtn_table  %>% 
  `rownames<-` (c(
    "Missing MNH08 at enrollment, n (%)",
    "Missing MNH08 at ANC32, n (%)",
    "Missing Proteinuria at <20 weeks' gestation (baseline), n (%)",
    "Missing Proteinuria at >=20 weeks' gestation, n (%)",
    "Missing Hemoglobin (CBC and POC) at ANC32, n (%)",
    "Missing Indirect Bilirubin at ANC32, n (%)",
    "Missing AST at ANC32, n (%)",
    "Missing ALT at ANC32, n (%)",
    "Missing Platelets at ANC32, n (%)",
    "Missing Creatinine at ANC32, n (%)")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position")) %>% 
  
    pack_rows("Missing MNH08 at enrollment among those who delivered", 1, 1, label_row_css = "color: steelblue;") %>%
  pack_rows("Missing MNH08 at ANC32 among those who delivered and have passed their ANC32 visit window", 2, 2, label_row_css = "color: steelblue;") %>%
    pack_rows("Additinal missing variables among those who have delivered and have passed their ANC32 window", 3, 10, label_row_css = "color: steelblue;")
  
```
<br>
\newpage

### Onset of hypertension prior to 20 weeks gestation:
**Definition:** at least one measure of blood pressure >=140/90 <20 weeks gestation AND a second blood pressure >=140/90 at any gestational age OR
<br>

"At least one measure of blood pressure >=140/90 <20 weeks gestation AND use of anti-hypertensive medication among those who were clinically diagnosed before pregnancy or <20 weeks gestation" OR
<br>

Blood pressure ≥160/110 mmHg before pregnancy or <20 weeks’ gestation once

```{r}    
chtn_table <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    # cHTN
    "High BP = Yes " =
      paste0(sum(CHRON_HYPER == 1, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP = No " =
      paste0(sum(CHRON_HYPER == 0, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "High BP  = Missing " = 
      paste0(sum(is.na(CHRON_HYPER)),
             " (",
             format(round(sum(is.na(CHRON_HYPER))/n()*100,2), nsmall=2, digits=3),
             ")"),

     # CHRON_HYPER_MEAS_ANY2 - this is high BP at enrollment (<20 wks) AND once more during pregnancy
    "High BP - 2 measurements = Yes " = 
      paste0(sum(CHRON_HYPER_MEAS_ANY2 == 1, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_MEAS_ANY2 == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP - 2 measurements = No " = 
      paste0(sum(CHRON_HYPER_MEAS_ANY2 == 0, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_MEAS_ANY2 == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP - 2 measurements = Missing " = 
      paste0(sum(is.na(CHRON_HYPER_MEAS_ANY2)),
             " (",
             format(round(sum(is.na(CHRON_HYPER_MEAS_ANY2))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # CHRON_HYPER_DIAG - Those who are clinically diagnosed
      "cHTN Clinically Diagnosed = Yes " = 
      paste0(sum(CHRON_HYPER_DIAG == 1, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_DIAG == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "cHTN Clinically Diagnosed = No " = 
      paste0(sum(CHRON_HYPER_DIAG == 0, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_DIAG == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "cHTN Clinically Diagnosed = Missing " = 
      paste0(sum(is.na(CHRON_HYPER_DIAG)),
             " (",
             format(round(sum(is.na(CHRON_HYPER_DIAG))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
     # CHRON_HYPER_TREAT
    "cHTN Treatment = Yes " =
      paste0(sum(CHRON_HYPER_TREAT == 1 & CHRON_HYPER_DIAG==1, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_TREAT == 1 & CHRON_HYPER_DIAG==1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),

    "cHTN Treatment = No " =
      paste0(sum(CHRON_HYPER_TREAT == 0& CHRON_HYPER_DIAG==1, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_TREAT == 0 & CHRON_HYPER_DIAG==1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),

    "cHTN Treatment = Missing " =
      paste0(sum(is.na(CHRON_HYPER_TREAT) & CHRON_HYPER_DIAG==1),
             " (",
             format(round(sum(is.na(CHRON_HYPER_TREAT) & CHRON_HYPER_DIAG==1)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    
    # CHRON_HYPER_MEAS1_TREAT (1 high BP measurement + on Treatment)
    "High BP - 1 measurement + Treatment = Yes " =
      paste0(sum(CHRON_HYPER_MEAS1_TREAT == 1, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_MEAS1_TREAT == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),

    "High BP - 1 measurement + Treatment = No " =
      paste0(sum(CHRON_HYPER_MEAS1_TREAT == 0, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_MEAS1_TREAT == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),

    "High BP - 1 measurement + Treatment = Missing " =
      paste0(sum(is.na(CHRON_HYPER_MEAS1_TREAT)),
             " (",
             format(round(sum(is.na(CHRON_HYPER_MEAS1_TREAT))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "BP>=160/110 = Yes " = 
      paste0(sum(SEVERE_CHRON_HYPER_MEAS == 1, na.rm = TRUE),
             " (",
             format(round(sum(SEVERE_CHRON_HYPER_MEAS == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
        "BP>=160/110 = No " = 
      paste0(sum(SEVERE_CHRON_HYPER_MEAS == 0, na.rm = TRUE),
             " (",
             format(round(sum(SEVERE_CHRON_HYPER_MEAS == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
        "BP>=160/110 = Missing " = 
      paste0(sum(is.na(SEVERE_CHRON_HYPER_MEAS), na.rm = TRUE),
             " (",
             format(round(sum(is.na(SEVERE_CHRON_HYPER_MEAS))/n()*100,2), nsmall=2, digits=3),
             ")"),
      ) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
```

#### **Table 2a. Onset of high BP <20 weeks' gestation**
```{r}
chtn_table  %>% 
  `rownames<-` (c(
    "High BP = Yes ",
    "High BP = No ",
    "High BP = Missing ",
    
    "High BP - 2 measurements = Yes ",
    "High BP - 2 measurements = No ",
    "High BP - 2 measurements = Missing ",
    
    "cHTN Clinically Diagnosed = Yes ",
    "cHTN Clinically Diagnosed = No ",
    "cHTN Clinically Diagnosed = Missing ",
    
    "cHTN Treatment = Yes",
    "cHTN Treatment = No",
    "cHTN Treatment = Missing",
    
    "High BP - 1 measurement + Treatment = Yes ",
    "High BP - 1 measurement + Treatment = No ",
    "High BP - 1 measurement + Treatment = Missing ",
    
    "BP>=160/110 = Yes ",
    "BP>=160/110 = No ",
    "BP>=160/110 = Missing ")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position")) %>% 
  
    pack_rows("Onset of high BP <20 weeks' gestation (any definition)", 1, 3, label_row_css = "color: steelblue;") %>%
  pack_rows("Onset of high BP <20 weeks' gestation - 2 BP measures", 4, 6, label_row_css = "color: steelblue;") %>%
  pack_rows("Chronic Hypertension - clinical diagnosis", 7, 9, label_row_css = "color: steelblue;") %>%
 pack_rows("Chronic Hypertension with treatment among those with clinical diagnosis", 10, 12, label_row_css = "color: steelblue;") %>%
  pack_rows("Onset of high BP <20 weeks' gestation - 1 BP measurement + on treatment", 13, 15, label_row_css = "color: steelblue;") %>%
  pack_rows("Onset of severely high BP < 20 weeks gestation", 16, 18, label_row_css = "color: steelblue;")
  
```
<br>

### New onset of hypertension after 20 weeks' gestation
**Definition:** 
<br>
a) Two measures of BP >=140/90 at gestational age >=20 weeks OR 
<br>
b) One measure of BP >=140/90 at gestational age >=20 weeks AND use of anti-hypertensive medications >= 20 weeks OR 
<br>
c) One measure of BP >= 160/110 (severe hypertension)
<br>


```{r}
# HTN >=20 weeks

chtn_table <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    # gHTN
    
    "High BP >=20wks = Yes " =
      paste0(sum(GT20_HTN_MEAS_ANY == 1, na.rm = TRUE),
             " (",
             format(round(sum(GT20_HTN_MEAS_ANY == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP >=20wks = No " =
      paste0(sum(GT20_HTN_MEAS_ANY == 0, na.rm = TRUE),
             " (",
             format(round(sum(GT20_HTN_MEAS_ANY == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),

    "High BP >=20wks = Missing " = 
      paste0(sum(is.na(GT20_HTN_MEAS_ANY)),
             " (",
             format(round(sum(is.na(GT20_HTN_MEAS_ANY))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    
    # HIGH BP AT TWO TP ABOVE GA>=20 WEEKS (GT20_HTN_MEAS_ANY2)
        "High BP - 2 measurements = Yes " =
      paste0(sum(GT20_HTN_MEAS_ANY2 == 1, na.rm = TRUE),
             " (",
             format(round(sum(GT20_HTN_MEAS_ANY2 == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP - 2 measurements = No " =
      paste0(sum(GT20_HTN_MEAS_ANY2 == 0, na.rm = TRUE),
             " (",
             format(round(sum(GT20_HTN_MEAS_ANY2 == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP - 2 measurements = Missing " = 
      paste0(sum(is.na(GT20_HTN_MEAS_ANY2)),
             " (",
             format(round(sum(is.na(GT20_HTN_MEAS_ANY2))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
        # HIGH BP AT 1 TP ABOVE GA>=20 WEEKS + TREATMENT
        "High BP - 1 time point + Treatment = Yes " =
      paste0(sum(GT20_MEAS1_TREAT == 1, na.rm = TRUE),
             " (",
             format(round(sum(GT20_MEAS1_TREAT == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP - 1 time point + Treatment = No " =
      paste0(sum(GT20_MEAS1_TREAT == 0, na.rm = TRUE),
             " (",
             format(round(sum(GT20_MEAS1_TREAT == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP - 1 time point + Treatment = Missing " = 
      paste0(sum(is.na(GT20_MEAS1_TREAT)),
             " (",
             format(round(sum(is.na(GT20_MEAS1_TREAT))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    
      # Severely high BP after 20 weeks gestation at one TP
        "Severely high BP = Yes " =
      paste0(sum(SEVERE_GT20_HTN_MEAS == 1, na.rm = TRUE),
             " (",
             format(round(sum(SEVERE_GT20_HTN_MEAS == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "Severely high BP = No " =
      paste0(sum(SEVERE_GT20_HTN_MEAS == 0, na.rm = TRUE),
             " (",
             format(round(sum(SEVERE_GT20_HTN_MEAS == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "Severely high BP = Missing " = 
      paste0(sum(is.na(SEVERE_GT20_HTN_MEAS)),
             " (",
             format(round(sum(is.na(SEVERE_GT20_HTN_MEAS))/n()*100,2), nsmall=2, digits=3),
             ")")) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
  
```

#### **Table 2b. Onset of high Blood Pressure >=20 weeks' gestation**
```{r}
chtn_table  %>% 
  `rownames<-` (c(
    "High BP >=20 wks = Yes ",
    "High BP >=20 wks = No ",
    "High BP >=20 wks = Missing ",
    
    "High BP - 2 measurements = Yes ",
    "High BP - 2 measurements = No ",
    "High BP - 2 measurements = Missing ",
    
    "High BP - 1 measurement + treatment = Yes ",
    "High BP - 1 measurement + treatment = No ",
    "High BP - 1 measurement + treatment = Missing ",
    
    "BP >=160/110 = Yes ", 
    "BP >=160/110 = No ",
    "BP >=160/110 = Missing ")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position")) %>% 
  
    pack_rows("Onset of high BP >=20 weeks' gestation (any definition)", 1, 3, label_row_css = "color: steelblue;") %>%
    pack_rows("Onset of high BP >=20 week's gestation - 2 BP measures", 4, 6, label_row_css = "color: steelblue;") %>%
   pack_rows("Onset of high BP >=20 week's gestation - 1 BP measure + Treatment", 7, 9, label_row_css = "color: steelblue;") %>%
   pack_rows("Onset of severely high BP >=20 weeks' gestation", 10, 12, label_row_css = "color: steelblue;")

```
<br>

### Proteinuria
**Proteinuria at baseline:**
<br>
**Definition:** 
Urine dipstick 1+ or 2+ at enrollment <20 weeks
<br>

**Gestational proteinuria:**
**Definition:** 
Urine dipstick 1+ or 2+ >=20 weeks' gestation or IPC among those who did not have baseline proteinuria
<br>



```{r}
chtn_table <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    # Baseline Proteinuria
    "Baseline = Yes " =
      paste0(sum(PROTEINURIA_BASELINE == 1, na.rm = TRUE),
             " (",
             format(round(sum(PROTEINURIA_BASELINE == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "Baseline = No " =
      paste0(sum(PROTEINURIA_BASELINE == 0, na.rm = TRUE),
             " (",
             format(round(sum(PROTEINURIA_BASELINE == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "Baseline = Missing " =
      paste0(sum(is.na(PROTEINURIA_BASELINE)),
             " (",
             format(round(sum(is.na(PROTEINURIA_BASELINE))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    
    # GESTATIONAL PROTEINURIA
        "Gestational = Yes " =
      paste0(sum(PROTEINURIA_ANC_IPC == 1, na.rm = TRUE),
             " (",
             format(round(sum(PROTEINURIA_ANC_IPC == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "Gestational = No " =
      paste0(sum(PROTEINURIA_ANC_IPC == 0, na.rm = TRUE),
             " (",
             format(round(sum(PROTEINURIA_ANC_IPC == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "Gestational = Missing " =
      paste0(sum(is.na(PROTEINURIA_ANC_IPC)),
             " (",
             format(round(sum(is.na(PROTEINURIA_ANC_IPC))/n()*100,2), nsmall=2, digits=3),
             ")"))  %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)


```

#### **Table 2c. Proteinuria**
```{r}
chtn_table  %>% 
  `rownames<-` (c(
    "Baseline = Yes ",
    "Baseline = No ",
    "Baseline = Missing ",
    
    "Gestational = Yes ",
    "Gestational = No ",
    "Gestational = Missing ")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position")) %>% 
  
    pack_rows("Baseline Proteinuria (gestational age <20 weeks)", 1, 3, label_row_css = "color: steelblue;") %>%
  pack_rows("Gestational Proteinuria (gestational age >=20 weeks among those without baseline proteinuria)", 4, 6, label_row_css = "color: steelblue;") 
```

### Severe features of PE
**Definition:** 
<br>
BP≥160/100 mmHg OR
<br>
Hemolysis (severe anemia (hemoglobin <7g/dL) + bilirubin ≥20.52 &micro;mol/L) OR 
<br>
Creatinine >97.25 &micro;mol/dL OR 
<br>
AST ≥90 units/L OR 
<br>
ALT ≥120 units/L OR 
<br>
Platelets <100X10^3^ /mm^3^
<br>

**Variables used for Severe Features:**
<br>
Proteinuria: [M08_UA_PROT_LBORRES] from MNH08 and [UA_PROT_LBORRES] from MNH19
<br>
Hemoglobin: [HB_POC_LBORRES and CBC_HB_LBORRES] from MNH08 at ANC32
<br>
Indirect bilirubin: [IBILIRUBIN_LBORRES] from MNH08 at ANC32
<br>
Creatinine: [CREAT_UMOLL_LBORRES] from MNH08 at ANC32 and [CREAT_LBORRESU] from MNH19
<br>
Platelets: [CBC_PLATE_LBORRES] from MNH08 at ANC32 and [CBC_PLATELET_LBORRES] from MNH19
<br>
AST: [AST_UL_LBORRES] from MNH08 at ANC32 and [AST_UL_LBORRES] from MNH19 
<br>
ALT: [ALT_UL_LBORRES] from MNH08 at ANC 32 and [ALT_UL_LBORRES] from MNH19
<br>

```{r}
chtn_table <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    # SEVERE FEATURES
            "Severe features = Yes " =
      paste0(sum(MAT_PE_SEV_MEAS == 1, na.rm = TRUE),
             " (",
             format(round(sum(MAT_PE_SEV_MEAS == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "Severe features = No " =
      paste0(sum(MAT_PE_SEV_MEAS == 0, na.rm = TRUE),
             " (",
             format(round(sum(MAT_PE_SEV_MEAS == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "Severe features = Missing " =
      paste0(sum(is.na(MAT_PE_SEV_MEAS)),
             " (",
             format(round(sum(is.na(MAT_PE_SEV_MEAS))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # CATEGORY: SEVERE HTN
       "High BP>=160/110 = Yes " =
      paste0(sum(SEVERE_HTN == 1, na.rm = TRUE),
             " (",
             format(round(sum(SEVERE_HTN == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "High BP>=160/110 = No " =
      paste0(sum(SEVERE_HTN == 0, na.rm = TRUE),
             " (",
             format(round(sum(SEVERE_HTN == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "High BP>=160/110 = Missing " =
      paste0(sum(is.na(SEVERE_HTN)),
             " (",
             format(round(sum(is.na(SEVERE_HTN))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # ANEMIA
    
       "Severe anemia = Yes " =
      paste0(sum(ANEMIA == 1, na.rm = TRUE),
             " (",
             format(round(sum(ANEMIA == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "Severe anemia = No " =
      paste0(sum(ANEMIA == 0, na.rm = TRUE),
             " (",
             format(round(sum(ANEMIA == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "Severe anemia = Missing " =
      paste0(sum(is.na(ANEMIA)),
             " (",
             format(round(sum(is.na(ANEMIA))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # BILIRUBIN
    "High bilirubin = Yes"= 
      paste0(sum(BILIRUBIN == 1, na.rm = TRUE),
             " (",
             format(round(sum(BILIRUBIN == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "High bilirubin = No " =
      paste0(sum(BILIRUBIN == 0, na.rm = TRUE),
             " (",
             format(round(sum(BILIRUBIN == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "High bilirubin = Missing " =
      paste0(sum(is.na(BILIRUBIN)),
             " (",
             format(round(sum(is.na(BILIRUBIN))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # AST
     "High AST = Yes"= 
      paste0(sum(AST == 1, na.rm = TRUE),
             " (",
             format(round(sum(AST == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "High AST = No " =
      paste0(sum(AST == 0, na.rm = TRUE),
             " (",
             format(round(sum(AST == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "High AST = Missing " =
      paste0(sum(is.na(AST)),
             " (",
             format(round(sum(is.na(AST))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # ALT
     "High ALT = Yes"= 
      paste0(sum(ALT == 1, na.rm = TRUE),
             " (",
             format(round(sum(ALT == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "High ALT = No " =
      paste0(sum(ALT == 0, na.rm = TRUE),
             " (",
             format(round(sum(ALT == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "High ALT = Missing " =
      paste0(sum(is.na(ALT)),
             " (",
             format(round(sum(is.na(ALT))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # PLATELETS
     "Low Platelets = Yes" = 
      paste0(sum(PLATELETS == 1, na.rm = TRUE),
             " (",
             format(round(sum(PLATELETS == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "Low Platelets = No " =
      paste0(sum(PLATELETS == 0, na.rm = TRUE),
             " (",
             format(round(sum(PLATELETS == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "Low Platelets = Missing " =
      paste0(sum(is.na(PLATELETS)),
             " (",
             format(round(sum(is.na(PLATELETS))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # CREATININE
    "High Creatinine = Yes" = 
      paste0(sum(CREATININE == 1, na.rm = TRUE),
             " (",
             format(round(sum(CREATININE == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "High Creatinine = No " =
      paste0(sum(CREATININE == 0, na.rm = TRUE),
             " (",
             format(round(sum(CREATININE == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "High Creatinine = Missing " =
      paste0(sum(is.na(CREATININE)),
             " (",
             format(round(sum(is.na(CREATININE))/n()*100,2), nsmall=2, digits=3),
             ")")) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
    
```

#### **Table 2d. Severe features and components**
```{r}
chtn_table  %>% 
  `rownames<-` (c(
    "Severe features = Yes ",
    "Severe features = No ",
    "Severe features = Missing ",
    
    "High BP>=160/110 = Yes ",
    "High BP>=160/110 = No ",
    "High BP>=160/110 = Missing ",
    
    "Severe anemia = Yes",
    "Severe anemia = No",
    "Severe anemia = Missing",
    
    "High bilirubin = Yes",
    "High bilirubin = No", 
    "High bilirubin = Missing",
    
    "High AST = Yes",
    "High AST = No",
    "High AST = Missing",
    
    "High ALT = Yes",
    "High ALT = No",
    "High ALT = Missing",
    
    "Low Platelets = Yes",
    "Low Platelets = No",
    "Low Platelets = Missing",
    
    "High Creatinine = Yes",
    "High Creatinine = No",
    "High Creatinine = Missing")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position")) %>% 
  
  pack_rows("Severe Features", 1, 3, label_row_css = "color: steelblue;") %>%
  pack_rows("Severely high BP >=20 weeks gestation", 4, 6, label_row_css = "color: steelblue;") %>%
  pack_rows("Severe anemia (Hb <7g/dl)", 7,9, label_row_css = "color: steelblue;") %>%
  pack_rows("Bilirubin >=20.52", 10, 12, label_row_css = "color: steelblue;") %>%
  pack_rows("AST >=90", 13, 15, label_row_css = "color: steelblue;") %>%
  pack_rows("ALT >=120", 16, 18, label_row_css = "color: steelblue;") %>%
  pack_rows("Platelets <100,000", 19, 21, label_row_css = "color: steelblue;") %>%
  pack_rows("Creatinine >97.26", 22, 24, label_row_css = "color: steelblue;") 

```
<br>
\newpage

### Hypertensive Disorders of Pregnancy 
**Getational hypertension**
**Definition:** BP >=140/90 >=20 weeks' gestation among those without cHTN
<br>

**Preeclampsia (PE)**
**Definition:**
<br>
BP ≥140/90 ≥20 weeks gestation AND gestational proteinuria OR
<br>
BP ≥140/90 ≥20 weeks gestation AND severe features OR
<br>
BP ≥140/90 <20 weeks gestation AND gestational proteinuria OR
<br>
BP ≥140/90 <20 weeks gestation AND severe features
<br>

```{r}
chtn_table <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    # HDP
    "PE with severe features" =
      paste0(sum(HDP=="PE with severe features", na.rm = TRUE),
             " (",
             format(round(sum(HDP=="PE with severe features", na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
        "PE" =
      paste0(sum(HDP=="PE", na.rm = TRUE),
             " (",
             format(round(sum(HDP=="PE", na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
        "PE superimposed on cHTN" =
      paste0(sum(HDP=="PE superimposed on cHTN", na.rm = TRUE),
             " (",
             format(round(sum(HDP=="PE superimposed on cHTN", na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "gHTN" =
      paste0(sum(HDP=="gHTN", na.rm = TRUE),
             " (",
             format(round(sum(HDP=="gHTN", na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
        "cHTN" =
      paste0(sum(HDP=="cHTN", na.rm = TRUE),
             " (",
             format(round(sum(HDP=="cHTN", na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
            "No HDP" =
      paste0(sum(HDP=="No HDP", na.rm = TRUE),
             " (",
             format(round(sum(HDP=="No HDP", na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
                "HDP Missing " =
      paste0(sum(is.na(HDP), na.rm = TRUE),
             " (",
             format(round(sum(is.na(HDP))/n()*100,2), nsmall=2, digits=3),
             ")")) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
  
```

#### **Table 3. Hypertensive Disorders of Pregnancy (HDP)**
```{r}
chtn_table  %>% 
  `rownames<-` (c(
    "Preeclampisa with severe features",
    "Preeclampsia",
    "Preeclampsia superimposed on chronic hypertension",
    "Gestational hypertension",
    "Chronic Hypertension",
    "No HDP",
    "Missing HDP")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position")) 

```

<br>

<!-- ``` -->

<!-- ```{r} -->

<!-- temp.df <- df %>% select(MOMID, SITE, M06_BP_SYS_VSORRES_1_2, M06_BP_SYS_VSORRES_2_2, M06_BP_SYS_VSORRES_3_2, -->
<!--                              M06_BP_DIA_VSORRES_1_2, M06_BP_DIA_VSORRES_2_2, M06_BP_DIA_VSORRES_3_2, meanSBP_ANC20, meanDBP_ANC20) %>%  -->
<!--   filter(SITE=="Pakistan") -->

<!-- chtn_table <- df %>% -->
<!--  # rowwise() %>% -->
<!--   group_by(SITE) %>% -->
<!--   summarise( -->
<!--     # SBP at enrollment (ANC LT20) -->
<!--     "Missing SBP Enrollment, n (%)" = -->
<!--       paste0(sum(is.na(meanSBP_ANC_LT20)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(meanSBP_ANC_LT20))/sum(M06_MAT_VISIT_FORM_COMPLETED_1==1)*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     # DBP at enrollment (ANC LT20) -->
<!--     "Missing DBP Enrollment, n (%)" = -->
<!--       paste0(sum(is.na(meanDBP_ANC_LT20)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(meanDBP_ANC_LT20)) -->
<!--                           /sum(M06_MAT_VISIT_FORM_COMPLETED_1==1)*100, 2),nsmall=2, digits=3), #TODO: This DBP number is not coming out right. -->
<!--              ")")) %>% -->

<!--   t() %>% as.data.frame() %>% -->
<!--   `colnames<-`(c(.[1,])) %>% -->
<!--   slice(-1) -->
<!-- ``` -->

<!-- Table 1a. Missingness: -->
<!-- ```{r} -->
<!-- chtn_table  %>%  -->
<!--   `rownames<-` (c( -->
<!--     "Missing SBP Enrollment, n (%)", -->
<!--     "Missing DBP Enrollment, n (%)")) %>%  -->

<!--      mutate_all(funs(str_replace(., "NaN", "0"))) %>%  -->
<!--   kbl(caption = "", booktabs = TRUE) %>% -->
<!--   kable_paper(bootstrap_options = "striped",  -->
<!--               full_width = T, html_font = "Cambria", position = "left", -->
<!--               latex_options = c("repeat_header", "HOLD_position")) %>%  -->
<!--   kable_styling(font_size = 14) %>% -->
<!--   row_spec(0, extra_css = "border-bottom: 0px white;") %>% -->

<!--   pack_rows("Missing SBP and DBP variables (average of 3 measurements), n (%)", 1, 2, label_row_css = "color: steelblue;") -->
<!-- ``` -->

<!-- ```{r} -->

<!--   chtn_table2 <- chtn_diag_df %>% -->
<!--   rowwise() %>% -->
<!--   group_by(SITE) %>% -->
<!--   summarise( -->
<!--     # CHRON_HYPER_TREAT -->
<!--     "cHTN Treatment = Yes " = -->
<!--       paste0(sum(CHRON_HYPER_TREAT == 1, na.rm = TRUE), -->
<!--              " (", -->
<!--              format(round(sum(CHRON_HYPER_TREAT == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     "cHTN Treatment = No " = -->
<!--       paste0(sum(CHRON_HYPER_TREAT == 0, na.rm = TRUE), -->
<!--              " (", -->
<!--              format(round(sum(CHRON_HYPER_TREAT == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     "cHTN Treatment = Missing " = -->
<!--       paste0(sum(is.na(CHRON_HYPER_TREAT)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(CHRON_HYPER_TREAT))/n()*100,2), nsmall=2, digits=3), -->
<!--              ")")) %>% -->

<!--   t() %>% as.data.frame() %>% -->
<!--   `colnames<-`(c(.[1,])) %>% -->
<!--   slice(-1) -->


<!-- chtn_table2$Ghana <- NA -->
<!-- chtn_table2$Pakistan <- NA -->
<!-- ``` -->

<!-- ```{r} -->
<!-- chtn_table3 <- rbind(chtn_table, chtn_table2) -->
<!-- ``` -->


<!-- ```{r} -->
<!-- chtn_table3  %>%  -->
<!--   `rownames<-` (c( -->
<!--     "Missing SBP Enrollment, n (%)", -->
<!--     "Missing DBP Enrollment, n (%)", -->
<!--     "Yes, n (%)", # CHRON_HYPER DIAG + MEASURED + TREAT -->
<!--     "No, n (%)", #  -->
<!--     "Missing (Measured & Treatment & Clinical Diagnosis), n (%)", -->
<!--     " Measured Yes, n (%)", # MEASURED -->
<!--     "Measured No, n (%)", -->
<!--     "Measured Missing, n (%)", -->
<!--     "Diagnosed Yes, n (%)", # diagnosed -->
<!--     "Diagnosed No, n (%)", -->
<!--     "Diagnosed Missing, n (%)", -->
<!--     "Treatment Yes, n (%)", # TREATMENT -->
<!--     "Treatment No, n (%)", -->
<!--     "Treatment Missing, n (%)")) %>% -->


<!--   mutate_all(funs(str_replace(., "NaN", "0"))) %>%  -->
<!--   kbl(caption = "", booktabs = TRUE) %>% -->
<!--   kable_paper(bootstrap_options = "striped",  -->
<!--               full_width = T, html_font = "Cambria", position = "left", -->
<!--               latex_options = c("repeat_header", "HOLD_position")) %>%  -->
<!--   kable_styling(font_size = 14) %>% -->
<!--   row_spec(0, extra_css = "border-bottom: 0px white;") %>% -->

<!--   pack_rows("Missing SBP and DBP variables (average of 3 measurements), n (%)", 1, 2, label_row_css = "color: steelblue;") %>% -->
<!--   pack_rows("Chronic Hypertension, n (%)", 3, 5, label_row_css = "color: steelblue;") %>% # WHAT DOES 5,6 HERE SAY?  -->
<!--   pack_rows("Measured Chronic Hypertension at Enrollment, n (%)", 6, 8, label_row_css = "color: steelblue;") %>% -->
<!--   pack_rows("Clinical Diagnosis at Enrollment, n (%)", 9, 11, label_row_css = "color: steelblue;") %>% -->
<!--   pack_rows("On Treatment for Chronic Hypertension at Enrollment*, n (%)", 12, 14, label_row_css = "color: steelblue;") -->

<!-- ``` -->
<!-- ***Note:** Category: "On Treatment for Chronic Hypertension" is among those who are diagnosed with chronic hypertension -->
<!-- <br> -->
<!-- <br> -->
<!-- <br> -->
<!-- \newpage -->

<!-- ### Gestational Hypertension -->
<!-- **Definition:** A systolic blood pressure (SBP) ≥140 mm Hg or diastolic blood pressure (DBP) ≥90 mm Hg on two occasions at least 1 hour apart after 20 weeks' gestation among participants without chronic hypertension (cHTN) OR  -->
<!-- <br> -->
<!-- SBP≥140 mmHg or DBP≥90 mmHg at one occasion after 20 weeks' gestation AND treatment with medication among participants without cHTN OR  -->
<!-- <br>  -->
<!-- SBP≥160 mmHg or DBP≥90 mmHg at one occasion after 20 weeks' gestation among participants without cHTN -->

<!-- <br> -->

<!-- **Denominator:** Enrolled women have a completed pregnancy -->
<!-- <br> -->
<!-- <br> -->
<!-- <br> -->

<!-- **Table 2a. Missingness of Blood Pressure and Protein Measures** -->
<!-- ```{r} -->
<!-- missing_ghtn_table <- df %>% -->
<!--   rowwise() %>% -->
<!--   group_by(SITE) %>% -->
<!--   summarise( -->
<!--      # SBP AT ANC20 -->
<!--     "Missing SBP ANC20**, n (%)" = -->
<!--       paste0(sum(is.na(meanSBP_ANC20)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(meanSBP_ANC20))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     # DBP AT ANC20 -->
<!--     "Missing DBP ANC20**, n (%)" = -->
<!--       paste0(sum(is.na(meanDBP_ANC20)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(meanDBP_ANC20))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     # SBP AT ANC28 -->
<!--     "Missing SBP ANC28, n (%)" = -->
<!--       paste0(sum(is.na(meanSBP_ANC28)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(meanSBP_ANC28))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     # DBP AT ANC28 -->
<!--     "Missing DBP ANC28, n (%)" = -->
<!--       paste0(sum(is.na(meanDBP_ANC28)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(meanDBP_ANC28))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     # SBP AT ANC32 -->
<!--     "Missing SBP ANC32, n (%)" = -->
<!--       paste0(sum(is.na(meanSBP_ANC32)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(meanSBP_ANC32))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     # DBP AT ANC32 -->
<!--     "Missing DBP ANC32, n (%)" = -->
<!--       paste0(sum(is.na(meanDBP_ANC32)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(meanDBP_ANC32))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     # SBP AT ANC36 -->
<!--     "Missing SBP ANC36, n (%)" = -->
<!--       paste0(sum(is.na(meanSBP_ANC36)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(meanSBP_ANC36))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     # DBP AT ANC36 -->
<!--     "Missing DBP ANC36, n (%)" = -->
<!--       paste0(sum(is.na(meanDBP_ANC36)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(meanDBP_ANC36))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     # SBP AT IPC -->
<!--     "Missing SBP IPC, n (%)" = -->
<!--       paste0(sum(is.na(meanSBP_IPC)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(meanSBP_IPC))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     # DBP AT IPC -->
<!--     "Missing DBP IPC, n (%)" = -->
<!--       paste0(sum(is.na(meanDBP_IPC)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(meanDBP_IPC))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     # PROTEINURIA ANC20 -->
<!--     "Missing Proteinuria ANC20, n (%)" = -->
<!--       paste0(sum(is.na(M08_UA_PROT_LBORRES_2)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(M08_UA_PROT_LBORRES_2))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     # PROTEINURIA ANC28 -->
<!--     "Missing Proteinuria ANC28, n (%)" = -->
<!--       paste0(sum(is.na(M08_UA_PROT_LBORRES_3)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(M08_UA_PROT_LBORRES_3))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     # PROTEINURIA ANC32 -->
<!--     "Missing Proteinuria ANC32, n (%)" = -->
<!--       paste0(sum(is.na(M08_UA_PROT_LBORRES_4)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(M08_UA_PROT_LBORRES_4))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     # PROTEINURIA ANC36 -->
<!--     "Missing Proteinuria ANC36, n (%)" = -->
<!--       paste0(sum(is.na(M08_UA_PROT_LBORRES_5)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(M08_UA_PROT_LBORRES_5))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     #   # PROTEINURIA ANC Hospitalization -->
<!--     # "Missing Proteinuria ANC Hospitalization, n (%)" = -->
<!--     #   paste0(sum(is.na(M08_UA_PROT_LBORRES_13)), -->
<!--     #          " (", -->
<!--     #          format(round(sum(is.na(M08_UA_PROT_LBORRES_13))/n()*100, 2),nsmall=2, digits=3), -->
<!--     #          ")"), -->

<!--         # PROTEINURIA IPC -->
<!--     "Missing Proteinuria IPC, n (%)" = -->
<!--       paste0(sum(is.na(M08_UA_PROT_LBORRES_6)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(M08_UA_PROT_LBORRES_6))/n()*100, 2),nsmall=2, digits=3), -->
<!--              ")")) %>% -->

<!--   t() %>% as.data.frame() %>%  -->
<!--   `colnames<-`(c(.[1,])) %>%  -->
<!--   slice(-1) -->


<!--         # AT HOSPITALIZATION ALL ARE MISSING - DON'T SHOW. -->
<!--     # # SBP AT ANC HOSP -->
<!--     # "Missing SBP ANC Hospitalization, n (%)" = -->
<!--     #   paste0(sum(is.na(meanSBP_Hosp_ANC)), -->
<!--     #          " (", -->
<!--     #          format(round(sum(is.na(meanSBP_Hosp_ANC))/n()*100, 2),nsmall=2, digits=3), -->
<!--     #          ")"), -->
<!--     #  -->
<!--     # # DBP AT ANC HOSP -->
<!--     # "Missing DBP ANC Hospitalization, n (%)" = -->
<!--     #   paste0(sum(is.na(meanDBP_Hosp_ANC)), -->
<!--     #          " (", -->
<!--     #          format(round(sum(is.na(meanDBP_Hosp_ANC))/n()*100, 2),nsmall=2, digits=3), -->
<!--     #          ")"), -->

<!-- ``` -->

<!-- ```{r} -->
<!-- missing_ghtn_table  %>%  -->
<!--   `rownames<-` (c( -->
<!--     "Missing SBP ANC20, n (%)", -->
<!--     "Missing DBP ANC20, n (%)", -->
<!--     "Missing SBP ANC28, n (%)", -->
<!--     "Missing DBP ANC28, n (%)", -->
<!--     "Missing SBP ANC32, n (%)", -->
<!--     "Missing DBP ANC32, n (%)", -->
<!--     "Missing SBP ANC36, n (%)", -->
<!--     "Missing DBP ANC36, n (%)", -->
<!--     "Missing SBP IPC, n (%)", -->
<!--     "Missing DBP IPC, n (%)", -->
<!--     "Missing Proteinuria ANC20, n (%)", -->
<!--     "Missing Proteinuria ANC28, n (%)", -->
<!--     "Missing Proteinuria ANC32, n (%)", -->
<!--     "Missing Proteinuria ANC36, n (%)", -->
<!--     #"Missing Proteinuria ANC Hospitalization, n (%)", -->
<!--     "Missing Proteinuria IPC, n (%)")) %>% -->


<!--   mutate_all(funs(str_replace(., "NaN", "0"))) %>%  -->
<!--   kbl(caption = "", booktabs = TRUE) %>% -->
<!--   kable_paper(bootstrap_options = "striped",  -->
<!--               full_width = T, html_font = "Cambria", position = "left", -->
<!--               latex_options = c("repeat_header", "HOLD_position")) %>%  -->
<!--   kable_styling(font_size = 14) %>% -->
<!--   row_spec(0, extra_css = "border-bottom: 0px white;") %>% -->

<!--   pack_rows("Missing SBP and DBP variables (average of 3 measurements), n (%)", 1, 10, label_row_css = "color: steelblue;") %>% -->
<!--   pack_rows("Missing Proteinuria labs, n (%)", 11, 15, label_row_css = "color: steelblue;") -->

<!-- ``` -->
<!-- **Note:** **ANC20 BP not required if enrolled at weeks 18/19. -->
<!-- <br> -->
<!-- <br> -->
<!-- <br> -->
<!-- \newpage -->



<!-- ```{r} -->
<!-- ghtn_table  %>%  -->
<!--   `rownames<-` (c( -->
<!--     "gHTN = Yes", # OERALL gHTN -->
<!--     "gHTN = No", -->
<!--     "gHTN = Missing", -->
<!--     "gHTN w/o Proteinuria = Yes", -->
<!--     "gHTN w/o Proteinuria = No", -->
<!--     "gHTN w/o Proteinuria = Missing")) %>% -->

<!--    mutate_all(funs(str_replace(., "NaN", "0"))) %>%  -->
<!--   kbl(caption = "", booktabs = TRUE) %>% -->
<!--   kable_paper(bootstrap_options = "striped",  -->
<!--               full_width = T, html_font = "Cambria", position = "left", -->
<!--               latex_options = c("repeat_header", "HOLD_position")) %>%  -->
<!--   kable_styling(font_size = 14) %>% -->
<!--   row_spec(0, extra_css = "border-bottom: 0px white;") %>% -->

<!--   pack_rows("Gestational Hypertension including Proteinuria, n (%)", 1, 3, label_row_css = "color: steelblue;") %>% -->
<!--   pack_rows("Gestational Hypertension excluding Proteinuria, n (%)", 4, 6, label_row_css = "color: steelblue;") -->

<!-- ``` -->
<!--  <br> -->
<!--  <br> -->
<!--  <br> -->
<!--  \newpage -->

<!-- **Table 2c. Prevalence of Each Component Contributing to Gestational Hypertension** -->
<!-- ```{r}    -->

<!-- vars_ghtn_table <- df %>% -->
<!--   rowwise() %>% -->
<!--   group_by(SITE) %>% -->
<!--   summarise( -->
<!--         # gHNT MEASURED 2+  CATEGORIES: -->
<!--     #Measured gHTN at 2 visits after 20 weeks gestation, at ANC hosp. and at L&D -->
<!--     " gHTN (Measured 2+) = Yes " =  -->
<!--       paste0(sum(GEST_HYPER_MEAS_ANY2 == 1, na.rm = TRUE), -->
<!--              " (", -->
<!--              format(round(sum(GEST_HYPER_MEAS_ANY2 == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     "gHTN (Measured 2+) = No " =  -->
<!--       paste0(sum(GEST_HYPER_MEAS_ANY2 == 0, na.rm = TRUE), -->
<!--              " (", -->
<!--              format(round(sum(GEST_HYPER_MEAS_ANY2 == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->

<!--         "gHTN (Measured 2+) = Missing " =  -->
<!--       paste0(sum(is.na(GEST_HYPER_MEAS_ANY2)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(GEST_HYPER_MEAS_ANY2))/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->

<!--         # gHNT MEASURED 1 CATEGORIES: -->
<!--     #Measured gHTN at 1 visit after 20 weeks gestation, at ANC hosp. and at L&D -->
<!--     " gHTN (Measured 1+) = Yes " =  -->
<!--       paste0(sum(GEST_HYPER_MEAS_ANY1 == 1, na.rm = TRUE), -->
<!--              " (", -->
<!--              format(round(sum(GEST_HYPER_MEAS_ANY1 == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     "gHTN (Measured 1+) = No " =  -->
<!--       paste0(sum(GEST_HYPER_MEAS_ANY1 == 0, na.rm = TRUE), -->
<!--              " (", -->
<!--              format(round(sum(GEST_HYPER_MEAS_ANY1 == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->

<!--         "gHTN (Measured 1+) = Missing " =  -->
<!--       paste0(sum(is.na(GEST_HYPER_MEAS_ANY1)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(GEST_HYPER_MEAS_ANY1))/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->

<!--             # gHTN TREATED CATEGORIES: -->
<!--     #Treatment assessed after 20 weeks gestation, at ANC hosp. and at L&D -->

<!--      "gHTN (Treatment) = Yes " =  -->
<!--       paste0(sum(GEST_HYPER_TREAT == 1, na.rm = TRUE), -->
<!--              " (", -->
<!--              format(round(sum(GEST_HYPER_TREAT == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     "gHTN (Treatment) = No " =  -->
<!--       paste0(sum(GEST_HYPER_TREAT == 0, na.rm = TRUE), -->
<!--              " (", -->
<!--              format(round(sum(GEST_HYPER_TREAT == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->

<!--         "gHTN (Treatment) = Missing " =  -->
<!--       paste0(sum(is.na(GEST_HYPER_TREAT)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(GEST_HYPER_TREAT))/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->

<!--                 # gHTN MEASURED 1 + TREATED CATEGORIES: -->
<!--     #Treatment assessed after 20 weeks gestation, at ANC hosp. and at L&D -->
<!--     "gHTN (Measured 1 + Treatment) = Yes " =  -->
<!--       paste0(sum(GEST_HYPER_MEAS1_TREAT == 1, na.rm = TRUE), -->
<!--              " (", -->
<!--              format(round(sum(GEST_HYPER_MEAS1_TREAT == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->

<!--     "gHTN (Measured 1 + Treatment) = No " =  -->
<!--       paste0(sum(GEST_HYPER_MEAS1_TREAT == 0, na.rm = TRUE), -->
<!--              " (", -->
<!--              format(round(sum(GEST_HYPER_MEAS1_TREAT == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->

<!--         "gHTN (Measured 1 + Treatment) = Missing " =  -->
<!--       paste0(sum(is.na(GEST_HYPER_MEAS1_TREAT)), -->
<!--              " (", -->
<!--              format(round(sum(is.na(GEST_HYPER_MEAS1_TREAT))/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->
<!--  "Proteinuria = Yes " =  -->
<!--    paste0(sum(PROTEINURIA_ANC_IPC == 1, na.rm = TRUE), -->
<!--              " (", -->
<!--              format(round(sum(PROTEINURIA_ANC_IPC == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->
<!--   "Proteinuria = No " =  -->
<!--    paste0(sum(PROTEINURIA_ANC_IPC == 0, na.rm = TRUE), -->
<!--              " (", -->
<!--              format(round(sum(PROTEINURIA_ANC_IPC == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3), -->
<!--              ")"), -->
<!--   "Proteinuria = Missing " =  -->
<!--    paste0(sum(is.na(PROTEINURIA_ANC_IPC), na.rm = TRUE), -->
<!--              " (", -->
<!--              format(round(sum(is.na(PROTEINURIA_ANC_IPC), na.rm = TRUE)/n()*100,2), nsmall=2, digits=3), -->
<!--              ")")) %>% -->

<!--   t() %>% as.data.frame() %>%  -->
<!--   `colnames<-`(c(.[1,])) %>%  -->
<!--   slice(-1) -->

<!-- ``` -->


<!-- ```{r} -->
<!-- vars_ghtn_table  %>%  -->
<!--   `rownames<-` (c( -->
<!--     "gHTN (Measured 2+) = Yes n (%)", -->
<!--     "gHTN (Measured 2+) = No n (%)", -->
<!--     "gHTN (Measured 2+) = Missing n (%)", -->
<!--     "gHTN (Measured 1+) = Yes n (%)", -->
<!--     "gHTN (Measured 1+) = No n (%)", -->
<!--     "gHTN (Measured 1+) = Missing n (%)", -->
<!--     "gHTN (Treatment) = Yes n (%)", -->
<!--     "gHTN (Treatment) = No n (%)", -->
<!--     "gHTN (Treatment) = Missing n (%)", -->
<!--     "gHTN (Measured 1 + & Treatment) = Yes n (%)", -->
<!--     "gHTN (Measured 1 + & Treatment) = No n (%)", -->
<!--     "gHTN (Measured 1 + & Treatment) = Missing n (%)", -->
<!--     "Proteinuria = Yes n (%)", -->
<!--     "Proteinuria = No n (%)", -->
<!--     "Proteinuria = Missing n (%)")) %>% -->

<!--   mutate_all(funs(str_replace(., "NaN", "0"))) %>%  -->
<!--   kbl(caption = "", booktabs = TRUE) %>% -->
<!--   kable_paper(bootstrap_options = "striped",  -->
<!--               full_width = T, html_font = "Cambria", position = "left", -->
<!--               latex_options = c("repeat_header", "HOLD_position")) %>%  -->
<!--   kable_styling(font_size = 14) %>% -->
<!--   row_spec(0, extra_css = "border-bottom: 0px white;") %>% -->

<!--   pack_rows("Measured gestational hypertension  (Measured 2+), n (%)", 1, 3, label_row_css = "color: steelblue;") %>% -->
<!--   pack_rows("Measured gestational hypertension  (Measured 1+), n (%)", 4, 6, label_row_css = "color: steelblue;") %>% -->
<!--   pack_rows("Measured gestational hypertension  (Treatment), n (%)", 7, 9, label_row_css = "color: steelblue;") %>% -->
<!--   pack_rows("Measured gestational hypertension  (Measured 1+ & Treatment), n (%)", 10, 12, label_row_css = "color: steelblue;") %>% -->
<!--   pack_rows("Proteinuria, n (%)", 13, 14, label_row_css = "color: steelblue;") -->

<!-- ``` -->
