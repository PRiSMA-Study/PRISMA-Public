---
title: "<span style='font-size: 18px'> <span style='text-align: center'> PRISMA-Maternal-Outcomes (Hypertensive Disorders of Pregnancy) (Issued: `r Sys.Date()`)"
author: 'Author: Fouzia Farooq'
output:
  html_document:
    df_print: paged
    toc: yes
    toc_depth: 4

---

&nbsp;
&nbsp;
&nbsp;
&nbsp;


##### **Includes data from synapse last updated:** {.unlisted .unnumbered}
#####  **Ghana: 2023-10-13** {.unlisted .unnumbered}
#####  **Kenya: 2023-10-13** {.unlisted .unnumbered}
#####  **Pakistan: 2023-10-13** {.unlisted .unnumbered}
#####  **Zambia: 2023-10-13** {.unlisted .unnumbered}


```{css, echo=FALSE}
.table caption {
  color: black;
  font-weight: bold;
}
```


```{r, data setup, include = FALSE}

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
#
```

```{r}
library(knitr)
library(tidyverse)
library(reshape2)
library(lubridate)
library(kableExtra)
library(emo)
library(naniar)
library(dplyr)
library(RColorBrewer)
```

```{r}
# AMONG WOMEN WHO HAVE DELIVERED
htn_df2 <- read.csv('../data_out/mat_HDP_tables_20231030.csv', header = TRUE)
df <- htn_df2 

missing_mnh08_df <- read.csv('../data_out/missing_mnh08_df_delivered_20231026.csv')
chtn_diag_df <- read.csv('../data_out/chtn_diag_df.csv', header=TRUE)
```

<br>
<br>
<br>

\newpage

### Total number of BP measurements across visits
```{r}

chtn_table <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    "6 BP measurements, n (%)" =
      paste0(sum(SUM_BP==6),
             " (",
             format(round(sum(SUM_BP==6)/n()*100, 2),nsmall=2, digits=3),
             ")"),
    
    "5 BP measurements, n (%)" =
      paste0(sum(SUM_BP==5),
             " (",
             format(round(sum(SUM_BP==5)/n()*100, 2),nsmall=2, digits=3),
             ")"),
    
    "4 BP measurements, n (%)" =
      paste0(sum(SUM_BP==4),
             " (",
             format(round(sum(SUM_BP==4)/n()*100, 2),nsmall=2, digits=3),
             ")"),
    
    "3 BP measurements, n (%)" =
      paste0(sum(SUM_BP==3),
             " (",
             format(round(sum(SUM_BP==3)/n()*100, 2),nsmall=2, digits=3),
             ")"),
    
    "2 BP measurements, n (%)" =
      paste0(sum(SUM_BP==2),
             " (",
             format(round(sum(SUM_BP==2)/n()*100, 2),nsmall=2, digits=3),
             ")"),
    
    "1 BP measurements, n (%)" =
      paste0(sum(SUM_BP==1),
             " (",
             format(round(sum(SUM_BP==1)/n()*100, 2),nsmall=2, digits=3),
             ")"),
    
    "0 BP measurements, n (%)" =
      paste0(sum(SUM_BP==0),
             " (",
             format(round(sum(SUM_BP==0)/n()*100, 2),nsmall=2, digits=3),
             ")")) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
```

#### **Table 1a. Total number of BP measurements across visits until delivery (from MNH06)**
```{r}
chtn_table  %>% 
  `rownames<-` (c(
    "6 BP measurements, n (%)",
    "5 BP measurements, n (%)",
    "4 BP measurements, n (%)",
    "3 BP measurements, n (%)",
    "2 BP measurements, n (%)",
    "1 BP measurements, n (%)",
    "0 BP measurements, n (%)")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position")) %>% 
  kable_styling(font_size = 14) %>%
  row_spec(0, extra_css = "border-bottom: 0px white;") %>%
  
  pack_rows("Blood Pressure measurements, n (%)", 1, 7, label_row_css = "color: steelblue;")
```

\newpage

### Data missingness 

```{r}
# JUST LOOKING AT MISSINGNESS IN MNH08 ENROLLMENT
missing_mnh08_df2 <- missing_mnh08_df %>%   
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    # Missing MNH08 at enrollment among those who delivered and have passed their Enrollment visit window
    "Missing MNH08 at enrollment, n (%)" =
      paste0(sum(M08_MAT_VISIT_FORM_COMPLETED_1 %in% c(0, NA) & ENROLL_PASS==1, na.rm = TRUE),
             " (",
             format(round(sum(M08_MAT_VISIT_FORM_COMPLETED_1 %in% c(0, NA) & ENROLL_PASS==1, na.rm = TRUE)/(sum(ENROLL_PASS==1, na.rm=TRUE))*100, 2),nsmall=2, digits=3),
             ")"),
    
    # Missing MNH08 at ANC32 among those who delivered and have passed their ANC32 visit window
    "Missing MNH08 at ANC32 , n (%)" =
      paste0(sum(M08_MAT_VISIT_FORM_COMPLETED_3==0 & ANC32_PASS==1, na.rm = TRUE),
             " (",
             format(round(sum(M08_MAT_VISIT_FORM_COMPLETED_3==0 & ANC32_PASS==1, na.rm = TRUE)/(sum(ANC32_PASS==1, na.rm=TRUE))*100, 2),nsmall=2, digits=3),
             ")"),
    
    "Missing MNH08 at ANC36 , n (%)" =
      paste0(sum(M08_MAT_VISIT_FORM_COMPLETED_4==0 & ANC36_PASS==1, na.rm = TRUE),
             " (",
             format(round(sum(M08_MAT_VISIT_FORM_COMPLETED_4==0 & ANC36_PASS==1, na.rm = TRUE)/(sum(ANC36_PASS==1, na.rm=TRUE))*100, 2),nsmall=2, digits=3),
             ")")) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
```

```{r}
# HAVE TO SET UP NO. MISSING AS FOLLOWS: MISSING PROTEINRUIA AMONG THOSE WHO HAVE A COMPLETED FORM DIVIVDED BY EVERYONE WITH A MISSING FORM

# Should this be setup over ANC32_PASS? b/c there are ppl who should have an MNH08 ANC32 but don't have it. 

other_missing <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    "Missing Proteinuria at <20 weeks' gestation (baseline), n (%)" =
      # MISSING PROTEINURIA AMONG THOSE WHO HAVE AN MNH08 FORM COMPLETED AT ENROLLMENT
      paste0(sum(is.na(PROTEINURIA_BASELINE) & M08_MAT_VISIT_FORM_COMPLETED_1==1, na.rm = TRUE),
             " (",
             format(round(sum(is.na(PROTEINURIA_BASELINE) &
                                M08_MAT_VISIT_FORM_COMPLETED_1==1, na.rm = TRUE)/(sum(M08_MAT_VISIT_FORM_COMPLETED_1==1, na.rm = TRUE))*100, 2),nsmall=2, digits=3),
             ")"),
    
    "Missing Proteinuria at >=20 weeks' gestation, n (%)" = 
       paste0(sum(is.na(PROTEINURIA_ANC_IPC)),
             " (",
             format(round(sum(is.na(PROTEINURIA_ANC_IPC))/n()*100, 2),nsmall=2, digits=3),
             ")"),
  
    
    "Missing Hb (CBC and POC) at ANC32 and ANC36, n (%)" =
      # MISSING Anemia at ANC-32 among those who have a completed ANC32 form (VISIT 4)
      paste0(sum((is.na(MAT_ANEMIA_MEAS4) & ANC32_PASS==1) & (is.na(MAT_ANEMIA_MEAS5) & ANC36_PASS==1), na.rm = TRUE),
             " (",
             format(round(sum((is.na(MAT_ANEMIA_MEAS4) & ANC32_PASS==1) & (is.na(MAT_ANEMIA_MEAS5) & ANC36_PASS==1), na.rm = TRUE)/(sum(ANC32_PASS==1 & ANC36_PASS==1, na.rm = TRUE))*100, 2),nsmall=2, digits=3),
             ")"),
    
    "Missing Bilirubin at ANC32 and ANC36, n (%)" =
      # MISSING Bilirubin at ANC-32 among those who have a completed ANC32 form (VISIT 4)
      paste0(sum((is.na(M08_IBILIRUBIN_LBORRES_4) & ANC32_PASS==1) & (is.na(M08_IBILIRUBIN_LBORRES_5) & ANC36_PASS==1), na.rm = TRUE),
             " (",
             format(round(sum((is.na(M08_IBILIRUBIN_LBORRES_4) & ANC32_PASS==1) & (is.na(M08_IBILIRUBIN_LBORRES_5) & ANC36_PASS==1), na.rm = TRUE)/(sum(ANC32_PASS==1 & ANC36_PASS==1, na.rm = TRUE))*100, 2),nsmall=2, digits=3),
             ")"),
    
    "Missing AST at ANC32 and ANC36, n (%)" =
      # MISSING AST at ANC-32 among those who have a completed ANC32 form (VISIT 4)
      paste0(sum((is.na(M08_AST_UL_LBORRES_4) & ANC32_PASS==1) & (is.na(M08_AST_UL_LBORRES_5) & ANC36_PASS==1), na.rm = TRUE),
             " (",
             format(round(sum((is.na(M08_AST_UL_LBORRES_4) & ANC32_PASS==1) & (is.na(M08_AST_UL_LBORRES_5) & ANC36_PASS==1), na.rm = TRUE)/(sum(ANC32_PASS==1 & ANC36_PASS==1, na.rm = TRUE))*100, 2),nsmall=2, digits=3),
             ")"),
    
    "Missing ALT at ANC32 and ANC36, n (%)" =
      # MISSING AST at ANC-32 among those who have a completed ANC32 form (VISIT 4)
      paste0(sum((is.na(M08_ALT_UL_LBORRES_4) & ANC32_PASS==1) & (is.na(M08_ALT_UL_LBORRES_5) & ANC36_PASS==1), na.rm = TRUE),
             " (",
             format(round(sum((is.na(M08_ALT_UL_LBORRES_4) & ANC32_PASS==1) & (is.na(M08_ALT_UL_LBORRES_5) & ANC36_PASS==1), na.rm = TRUE)/(sum(ANC32_PASS==1 & ANC36_PASS==1, na.rm = TRUE))*100, 2),nsmall=2, digits=3),
             ")"),
  
    
    "Missing PLATELETS at ANC32 and ANC36, n (%)" =
      # MISSING AST at ANC-32 among those who have a completed ANC32 form (VISIT 4)
      paste0(sum((is.na(M08_CBC_PLATE_LBORRES_4) & ANC32_PASS==1) & (is.na(M08_CBC_PLATE_LBORRES_5) & ANC36_PASS==1), na.rm = TRUE),
             " (",
             format(round(sum((is.na(M08_CBC_PLATE_LBORRES_4) & ANC32_PASS==1) & (is.na(M08_CBC_PLATE_LBORRES_5) & ANC36_PASS==1), na.rm = TRUE)/(sum(ANC32_PASS==1 & ANC36_PASS==1, na.rm = TRUE))*100, 2),nsmall=2, digits=3),
             ")"),

    
    "Missing CREATININE at ANC32 and ANC36, n (%)" =
      # MISSING AST at ANC-32 among those who have a completed ANC32 form (VISIT 4)
      paste0(sum((is.na(M08_CREAT_UMOLL_LBORRES_4) & ANC32_PASS==1) & (is.na(M08_CREAT_UMOLL_LBORRES_5) & ANC36_PASS==1), na.rm = TRUE),
             " (",
             format(round(sum((is.na(M08_CREAT_UMOLL_LBORRES_4) & ANC32_PASS==1) & (is.na(M08_CREAT_UMOLL_LBORRES_5) & ANC36_PASS==1), na.rm = TRUE)/(sum(ANC32_PASS==1 & ANC36_PASS==1, na.rm = TRUE))*100, 2),nsmall=2, digits=3),
             ")")) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
    
```

```{r}
chtn_table <- rbind(missing_mnh08_df2, other_missing)
```


#### **Table 1b. Data Missingness (forms and variables)**
```{r}

# GHTN table rename: New Onset High BP after 20 weeks - dont exclude Proteinuria.
# CHTN:(High BP prior to 20 weeks)
# Table 1b. Missingness among variables for Preeclampsia

chtn_table  %>% 
  `rownames<-` (c(
    "Missing MNH08 at enrollment, n (%)",
    "Missing MNH08 at ANC32, n (%)",
    "Missing MNH08 at ANC36, n (%)",
    "Missing Proteinuria at <20 weeks' gestation (baseline), n (%)",
    "Missing Proteinuria at >=20 weeks' gestation, n (%)",
    "Missing Hemoglobin (CBC and POC) at ANC32 or ANC36, n (%)",
    "Missing Indirect Bilirubin at ANC32 or ANC36, n (%)",
    "Missing AST at ANC32 or ANC36, n (%)",
    "Missing ALT at ANC32 or ANC36, n (%)",
    "Missing Platelets at ANC32 or ANC36, n (%)",
    "Missing Creatinine at ANC32 or ANC36, n (%)")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position")) %>% 
  
    pack_rows("Missing MNH08 at enrollment among those who delivered", 1, 1, label_row_css = "color: steelblue;") %>%
  pack_rows("Missing MNH08 forms at ANC32 and ANC 36", 2, 3, label_row_css = "color: steelblue;") %>%
    pack_rows("Missing Proteinuria variables", 4, 5, label_row_css = "color: steelblue;") %>%
  pack_rows("Missing MNH08 at ANC32 (GA >=34 weeks) and ANC 36 (GA >=38 weeks) among those who delivered", 6, 11, label_row_css = "color: steelblue;") 

```

\newpage

### Onset of hypertension prior to 20 weeks gestation:
**Definition:** 
<br>
<ul>
<li>At least one measure of systolic blood pressure (SBP) >=140 or diastolic blood pressure (DBP) >=90 <20 weeks gestation AND a SBP >=140 or DBP>=90 at any gestational age OR</li>
<li>At least one measure of SBP >=140 or DPB >=90 <20 weeks gestation AND use of anti-hypertensive medication among those who were clinically diagnosed before pregnancy or <20 weeks gestation" OR</li>
<li>SPB ≥160 or DBP>=110 mmHg before pregnancy or <20 weeks’ gestation once (severe hypertension) </li>
</ul>
<br>
<br>

\newpage 

```{r}    
chtn_table <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    # cHTN
    "High BP = Yes " =
      paste0(sum(CHRON_HYPER == 1, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP = No " =
      paste0(sum(CHRON_HYPER == 0, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "High BP  = Missing " = 
      paste0(sum(is.na(CHRON_HYPER)),
             " (",
             format(round(sum(is.na(CHRON_HYPER))/n()*100,2), nsmall=2, digits=3),
             ")"),

     # CHRON_HYPER_MEAS_ANY2 - this is high BP at enrollment (<20 wks) AND once more during pregnancy
    "High BP - 2 measurements = Yes " = 
      paste0(sum(CHRON_HYPER_MEAS_ANY2 == 1, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_MEAS_ANY2 == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP - 2 measurements = No " = 
      paste0(sum(CHRON_HYPER_MEAS_ANY2 == 0, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_MEAS_ANY2 == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP - 2 measurements = Missing " = 
      paste0(sum(is.na(CHRON_HYPER_MEAS_ANY2)),
             " (",
             format(round(sum(is.na(CHRON_HYPER_MEAS_ANY2))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # CHRON_HYPER_DIAG - Those who are clinically diagnosed
      "cHTN Clinically Diagnosed = Yes " = 
      paste0(sum(CHRON_HYPER_DIAG == 1, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_DIAG == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "cHTN Clinically Diagnosed = No " = 
      paste0(sum(CHRON_HYPER_DIAG == 0, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_DIAG == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "cHTN Clinically Diagnosed = Missing " = 
      paste0(sum(is.na(CHRON_HYPER_DIAG)),
             " (",
             format(round(sum(is.na(CHRON_HYPER_DIAG))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
     # CHRON_HYPER_TREAT
    "cHTN Treatment = Yes " =
      paste0(sum(CHRON_HYPER_TREAT == 1 & CHRON_HYPER_DIAG==1, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_TREAT == 1 & CHRON_HYPER_DIAG==1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),

    "cHTN Treatment = No " =
      paste0(sum(CHRON_HYPER_TREAT == 0& CHRON_HYPER_DIAG==1, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_TREAT == 0 & CHRON_HYPER_DIAG==1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),

    "cHTN Treatment = Missing " =
      paste0(sum(is.na(CHRON_HYPER_TREAT) & CHRON_HYPER_DIAG==1),
             " (",
             format(round(sum(is.na(CHRON_HYPER_TREAT) & CHRON_HYPER_DIAG==1)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    
    # CHRON_HYPER_MEAS1_TREAT (1 high BP measurement + on Treatment)
    "High BP - 1 measurement + Treatment = Yes " =
      paste0(sum(CHRON_HYPER_MEAS1_TREAT == 1, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_MEAS1_TREAT == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),

    "High BP - 1 measurement + Treatment = No " =
      paste0(sum(CHRON_HYPER_MEAS1_TREAT == 0, na.rm = TRUE),
             " (",
             format(round(sum(CHRON_HYPER_MEAS1_TREAT == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),

    "High BP - 1 measurement + Treatment = Missing " =
      paste0(sum(is.na(CHRON_HYPER_MEAS1_TREAT)),
             " (",
             format(round(sum(is.na(CHRON_HYPER_MEAS1_TREAT))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "BP>=160/110 = Yes " = 
      paste0(sum(SEVERE_CHRON_HYPER_MEAS == 1, na.rm = TRUE),
             " (",
             format(round(sum(SEVERE_CHRON_HYPER_MEAS == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
        "BP>=160/110 = No " = 
      paste0(sum(SEVERE_CHRON_HYPER_MEAS == 0, na.rm = TRUE),
             " (",
             format(round(sum(SEVERE_CHRON_HYPER_MEAS == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
        "BP>=160/110 = Missing " = 
      paste0(sum(is.na(SEVERE_CHRON_HYPER_MEAS), na.rm = TRUE),
             " (",
             format(round(sum(is.na(SEVERE_CHRON_HYPER_MEAS))/n()*100,2), nsmall=2, digits=3),
             ")"),
      ) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
```

#### **Table 2a. Onset of high BP <20 weeks' gestation**
```{r}
chtn_table  %>% 
  `rownames<-` (c(
    "High BP = Yes ",
    "High BP = No ",
    "High BP = Missing ",
    
    "High BP - 2 measurements = Yes ",
    "High BP - 2 measurements = No ",
    "High BP - 2 measurements = Missing ",
    
    "cHTN Clinically Diagnosed = Yes ",
    "cHTN Clinically Diagnosed = No ",
    "cHTN Clinically Diagnosed = Missing ",
    
    "cHTN Treatment = Yes",
    "cHTN Treatment = No",
    "cHTN Treatment = Missing",
    
    "High BP - 1 measurement + Treatment = Yes ",
    "High BP - 1 measurement + Treatment = No ",
    "High BP - 1 measurement + Treatment = Missing ",
    
    "BP>=160/110 = Yes ",
    "BP>=160/110 = No ",
    "BP>=160/110 = Missing ")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position")) %>% 
  
    pack_rows("Onset of high BP <20 weeks' gestation (any definition)", 1, 3, label_row_css = "color: steelblue;") %>%
  pack_rows("Onset of high BP <20 weeks' gestation - 2 BP measures", 4, 6, label_row_css = "color: steelblue;") %>%
  pack_rows("Chronic Hypertension - clinical diagnosis", 7, 9, label_row_css = "color: steelblue;") %>%
 pack_rows("Chronic Hypertension with treatment among those with clinical diagnosis", 10, 12, label_row_css = "color: steelblue;") %>%
  pack_rows("Onset of high BP <20 weeks' gestation - 1 BP measurement + on treatment", 13, 15, label_row_css = "color: steelblue;") %>%
  pack_rows("Onset of severely high BP <20 weeks gestation", 16, 18, label_row_css = "color: steelblue;")
  
```

\newpage


### New onset of hypertension at or after 20 weeks' gestation
**Definition:** 
<br>
<ul>
<li>Two measures of SBP>=140 mmHg or DBP>=90 mmHg at gestational age >=20 weeks OR</li>
<li>One measure of BP>=140 mmHg or DBP>=90 mmHg at gestational age >=20 weeks AND use of anti-hypertensive medications >= 20 weeks OR</li>
<li>One measure of BP>=160 mmHg or DBP>=110 mmHg (severe hypertension)</li>
</ul>
<br>
<br>

```{r}
# HTN >=20 weeks

chtn_table <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    # gHTN
    
    "High BP >=20wks = Yes " =
      paste0(sum(GT20_HTN_MEAS_ANY == 1, na.rm = TRUE),
             " (",
             format(round(sum(GT20_HTN_MEAS_ANY == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP >=20wks = No " =
      paste0(sum(GT20_HTN_MEAS_ANY == 0, na.rm = TRUE),
             " (",
             format(round(sum(GT20_HTN_MEAS_ANY == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),

    "High BP >=20wks = Missing " = 
      paste0(sum(is.na(GT20_HTN_MEAS_ANY)),
             " (",
             format(round(sum(is.na(GT20_HTN_MEAS_ANY))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    
    # HIGH BP AT TWO TP ABOVE GA>=20 WEEKS (GT20_HTN_MEAS_ANY2)
        "High BP - 2 measurements = Yes " =
      paste0(sum(GT20_HTN_MEAS_ANY2 == 1, na.rm = TRUE),
             " (",
             format(round(sum(GT20_HTN_MEAS_ANY2 == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP - 2 measurements = No " =
      paste0(sum(GT20_HTN_MEAS_ANY2 == 0, na.rm = TRUE),
             " (",
             format(round(sum(GT20_HTN_MEAS_ANY2 == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP - 2 measurements = Missing " = 
      paste0(sum(is.na(GT20_HTN_MEAS_ANY2)),
             " (",
             format(round(sum(is.na(GT20_HTN_MEAS_ANY2))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
        # HIGH BP AT 1 TP ABOVE GA>=20 WEEKS + TREATMENT
        "High BP - 1 time point + Treatment = Yes " =
      paste0(sum(GT20_MEAS1_TREAT == 1, na.rm = TRUE),
             " (",
             format(round(sum(GT20_MEAS1_TREAT == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP - 1 time point + Treatment = No " =
      paste0(sum(GT20_MEAS1_TREAT == 0, na.rm = TRUE),
             " (",
             format(round(sum(GT20_MEAS1_TREAT == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "High BP - 1 time point + Treatment = Missing " = 
      paste0(sum(is.na(GT20_MEAS1_TREAT)),
             " (",
             format(round(sum(is.na(GT20_MEAS1_TREAT))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    
      # Severely high BP after 20 weeks gestation at one TP
        "Severely high BP = Yes " =
      paste0(sum(SEVERE_GT20_HTN_MEAS == 1, na.rm = TRUE),
             " (",
             format(round(sum(SEVERE_GT20_HTN_MEAS == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "Severely high BP = No " =
      paste0(sum(SEVERE_GT20_HTN_MEAS == 0, na.rm = TRUE),
             " (",
             format(round(sum(SEVERE_GT20_HTN_MEAS == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "Severely high BP = Missing " = 
      paste0(sum(is.na(SEVERE_GT20_HTN_MEAS)),
             " (",
             format(round(sum(is.na(SEVERE_GT20_HTN_MEAS))/n()*100,2), nsmall=2, digits=3),
             ")")) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
  
```

#### **Table 2b. Onset of high Blood Pressure >=20 weeks' gestation**
```{r}
chtn_table  %>% 
  `rownames<-` (c(
    "High BP >=20 wks = Yes ",
    "High BP >=20 wks = No ",
    "High BP >=20 wks = Missing ",
    
    "High BP - 2 measurements = Yes ",
    "High BP - 2 measurements = No ",
    "High BP - 2 measurements = Missing ",
    
    "High BP - 1 measurement + treatment = Yes ",
    "High BP - 1 measurement + treatment = No ",
    "High BP - 1 measurement + treatment = Missing ",
    
    "BP >=160/110 = Yes ", 
    "BP >=160/110 = No ",
    "BP >=160/110 = Missing ")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position")) %>% 
  
    pack_rows("Onset of high BP >=20 weeks' gestation (any definition)", 1, 3, label_row_css = "color: steelblue;") %>%
    pack_rows("Onset of high BP >=20 week's gestation - 2 BP measures", 4, 6, label_row_css = "color: steelblue;") %>%
   pack_rows("Onset of high BP >=20 week's gestation - 1 BP measure + Treatment", 7, 9, label_row_css = "color: steelblue;") %>%
   pack_rows("Onset of severely high BP >=20 weeks' gestation", 10, 12, label_row_css = "color: steelblue;")

```
<br>

\newpage

### Proteinuria
**Proteinuria at baseline**
<br>
**Definition:** 
<br>
<ul>
<li>Urine dipstick 1+, 2+ 3+ or 4+ at enrollment <20 weeks.</li>
</ul>

**Gestational proteinuria**
<br>
**Definition:** 
<br>
<ul>
<li>Urine dipstick 1+, 2+ 3+ or 4+ >=20 weeks' gestation or IPC among those who did not have baseline proteinuria.</li>
</ul>
<br>


```{r}
chtn_table <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    # Baseline Proteinuria
    "Baseline = Yes " =
      paste0(sum(PROTEINURIA_BASELINE == 1, na.rm = TRUE),
             " (",
             format(round(sum(PROTEINURIA_BASELINE == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "Baseline = No " =
      paste0(sum(PROTEINURIA_BASELINE == 0, na.rm = TRUE),
             " (",
             format(round(sum(PROTEINURIA_BASELINE == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "Baseline = Missing " =
      paste0(sum(is.na(PROTEINURIA_BASELINE)),
             " (",
             format(round(sum(is.na(PROTEINURIA_BASELINE))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    
    # GESTATIONAL PROTEINURIA
        "Gestational = Yes " =
      paste0(sum(PROTEINURIA_ANC_IPC == 1, na.rm = TRUE),
             " (",
             format(round(sum(PROTEINURIA_ANC_IPC == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "Gestational = No " =
      paste0(sum(PROTEINURIA_ANC_IPC == 0, na.rm = TRUE),
             " (",
             format(round(sum(PROTEINURIA_ANC_IPC == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "Gestational = Missing " =
      paste0(sum(is.na(PROTEINURIA_ANC_IPC)),
             " (",
             format(round(sum(is.na(PROTEINURIA_ANC_IPC))/n()*100,2), nsmall=2, digits=3),
             ")"))  %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)


```

#### **Table 2c. Proteinuria**   
```{r}
chtn_table  %>% 
  `rownames<-` (c(
    "Baseline = Yes ",
    "Baseline = No ",
    "Baseline = Missing ",
    
    "Gestational = Yes ",
    "Gestational = No ",
    "Gestational = Missing ")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position")) %>% 
  
    pack_rows("Baseline Proteinuria (gestational age <20 weeks)", 1, 3, label_row_css = "color: steelblue;") %>%
  pack_rows("Gestational Proteinuria (gestational age >=20 weeks among those without baseline proteinuria)", 4, 6, label_row_css = "color: steelblue;") 
```

\newpage

### Severe features of PE
**Definition:** 
<br>
<ul>
<li>Severe hypertension: SBP>=160 mmHg or DBP>=110 mmHg once at GA >=20 weeks OR</li>
<li>Hemolysis: severe anemia (hemoglobin <7g/dL) AND indirect bilirubin ≥20.52 &micro;mol/L at ANC32 or ANC36 OR</li>
<li>Creatinine >97.25 &micro;mol/dL at ANC-32 or ANC-36 OR</li>
<li>AST ≥90 units/L at ANC-32 or ANC-36 OR</li>
<li>ALT ≥120 units/L at ANC-32 or ANC-36OR</li>
<li>Platelets <100X10^3^ /mm^3^ at ANC-32 or ANC-36</li>
</ul>

**Severe features only**
<br>
<ul>
<li>ONLY severe features as defined above (do not have Chronic hypertension, gestational hypertension or preeclampsia).</li>
<br>
</ul>

**Variables used for Severe Features:**
<br>
1) Proteinuria: [M08_UA_PROT_LBORRES] from MNH08 and [UA_PROT_LBORRES] from MNH19
<br>
2) Hemoglobin: [HB_POC_LBORRES and CBC_HB_LBORRES] from MNH08 at ANC32 or ANC36
<br>
3) Indirect bilirubin: [IBILIRUBIN_LBORRES] from MNH08 at ANC32
<br>
4) Creatinine: [CREAT_UMOLL_LBORRES] from MNH08 at ANC32 or ANC36 and [CREAT_LBORRESU] from MNH19
<br>
5) Platelets: [CBC_PLATE_LBORRES] from MNH08 at ANC32 or ANC36 and [CBC_PLATELET_LBORRES] from MNH19
<br>
6) AST: [AST_UL_LBORRES] from MNH08 at ANC32 or ANC36 and [AST_UL_LBORRES] from MNH19 
<br>
7) ALT: [ALT_UL_LBORRES] from MNH08 at ANC 32 or ANC36 and [ALT_UL_LBORRES] from MNH19
<br>
<br>

\newpage 

```{r}
chtn_table <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    # PE with SEVERE FEATURES
            "PE with Severe features = Yes " =
      paste0(sum(MAT_PE_SEV_FEAT_2ND == 1, na.rm = TRUE),
             " (",
             format(round(sum(MAT_PE_SEV_FEAT_2ND == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "PE with Severe features = No " =
      paste0(sum(MAT_PE_SEV_FEAT_2ND == 0, na.rm = TRUE),
             " (",
             format(round(sum(MAT_PE_SEV_FEAT_2ND == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "PE with Severe features = Missing " =
      paste0(sum(is.na(MAT_PE_SEV_FEAT_2ND)),
             " (",
             format(round(sum(is.na(MAT_PE_SEV_FEAT_2ND))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # # SEVERE FEATURES "ONLY"
    #           "Severe features only = Yes " =
    #   paste0(sum(SEV_FEAT_ONLY == 1 & MAT_PE_SEV_MEAS==1, na.rm = TRUE),
    #          " (",
    #          format(round(sum(SEV_FEAT_ONLY == 1 & MAT_PE_SEV_MEAS==1, 
    #                           na.rm = TRUE)/sum(MAT_PE_SEV_MEAS==1, na.rm = TRUE)*100,2), nsmall=2, digits=3),
    #          ")"),
    #     "Severe features only = No " =
    #   paste0(sum(SEV_FEAT_ONLY == 0 & MAT_PE_SEV_MEAS==1, na.rm = TRUE),
    #          " (",
    #          format(round(sum(SEV_FEAT_ONLY == 0 & MAT_PE_SEV_MEAS==1, 
    #                           na.rm = TRUE)/sum(MAT_PE_SEV_MEAS==1, na.rm = TRUE)*100,2), nsmall=2, digits=3),
    #          ")"),
    # #Missing I can keep as NA.
    # "Severe features only = Missing " =
    #   paste0(sum(is.na(SEV_FEAT_ONLY) & MAT_PE_SEV_MEAS==1),
    #          " (",
    #          format(round(sum(is.na(SEV_FEAT_ONLY)& MAT_PE_SEV_MEAS==1)/sum(is.na(MAT_PE_SEV_MEAS==1))*100,2), nsmall=2, digits=3),
    #          ")"),
    
    # CATEGORY: SEVERE HTN
       "High BP>=160/110 = Yes " =
      paste0(sum(SEVERE_HTN == 1, na.rm = TRUE),
             " (",
             format(round(sum(SEVERE_HTN == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "High BP>=160/110 = No " =
      paste0(sum(SEVERE_HTN == 0, na.rm = TRUE),
             " (",
             format(round(sum(SEVERE_HTN == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "High BP>=160/110 = Missing " =
      paste0(sum(is.na(SEVERE_HTN)),
             " (",
             format(round(sum(is.na(SEVERE_HTN))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # ANEMIA
    
       "Severe anemia = Yes " =
      paste0(sum(ANEMIA == 1, na.rm = TRUE),
             " (",
             format(round(sum(ANEMIA == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "Severe anemia = No " =
      paste0(sum(ANEMIA == 0, na.rm = TRUE),
             " (",
             format(round(sum(ANEMIA == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "Severe anemia = Missing " =
      paste0(sum(is.na(ANEMIA)),
             " (",
             format(round(sum(is.na(ANEMIA))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # BILIRUBIN
    "High bilirubin = Yes"= 
      paste0(sum(BILIRUBIN == 1, na.rm = TRUE),
             " (",
             format(round(sum(BILIRUBIN == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "High bilirubin = No " =
      paste0(sum(BILIRUBIN == 0, na.rm = TRUE),
             " (",
             format(round(sum(BILIRUBIN == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "High bilirubin = Missing " =
      paste0(sum(is.na(BILIRUBIN)),
             " (",
             format(round(sum(is.na(BILIRUBIN))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # AST
     "High AST = Yes"= 
      paste0(sum(AST == 1, na.rm = TRUE),
             " (",
             format(round(sum(AST == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "High AST = No " =
      paste0(sum(AST == 0, na.rm = TRUE),
             " (",
             format(round(sum(AST == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "High AST = Missing " =
      paste0(sum(is.na(AST)),
             " (",
             format(round(sum(is.na(AST))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # ALT
     "High ALT = Yes"= 
      paste0(sum(ALT == 1, na.rm = TRUE),
             " (",
             format(round(sum(ALT == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "High ALT = No " =
      paste0(sum(ALT == 0, na.rm = TRUE),
             " (",
             format(round(sum(ALT == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "High ALT = Missing " =
      paste0(sum(is.na(ALT)),
             " (",
             format(round(sum(is.na(ALT))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # PLATELETS
     "Low Platelets = Yes" = 
      paste0(sum(PLATELETS == 1, na.rm = TRUE),
             " (",
             format(round(sum(PLATELETS == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "Low Platelets = No " =
      paste0(sum(PLATELETS == 0, na.rm = TRUE),
             " (",
             format(round(sum(PLATELETS == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "Low Platelets = Missing " =
      paste0(sum(is.na(PLATELETS)),
             " (",
             format(round(sum(is.na(PLATELETS))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # CREATININE
    "High Creatinine = Yes" = 
      paste0(sum(CREATININE == 1, na.rm = TRUE),
             " (",
             format(round(sum(CREATININE == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "High Creatinine = No " =
      paste0(sum(CREATININE == 0, na.rm = TRUE),
             " (",
             format(round(sum(CREATININE == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "High Creatinine = Missing " =
      paste0(sum(is.na(CREATININE)),
             " (",
             format(round(sum(is.na(CREATININE))/n()*100,2), nsmall=2, digits=3),
             ")")) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
    
```


#### **Table 2d. Severe features and components**
```{r}
chtn_table  %>% 
  `rownames<-` (c(
    "Severe features = Yes ",
    "Severe features = No ",
    "Severe features = Missing ",
    
    # "Severe features only = Yes ",
    # "Severe features only = No ",
    # "Severe features only = Missing ",
    
    "High BP>=160/110 = Yes ",
    "High BP>=160/110 = No ",
    "High BP>=160/110 = Missing ",
    
    "Severe anemia = Yes",
    "Severe anemia = No",
    "Severe anemia = Missing",
    
    "High bilirubin = Yes",
    "High bilirubin = No", 
    "High bilirubin = Missing",
    
    "High AST = Yes",
    "High AST = No",
    "High AST = Missing",
    
    "High ALT = Yes",
    "High ALT = No",
    "High ALT = Missing",
    
    "Low Platelets = Yes",
    "Low Platelets = No",
    "Low Platelets = Missing",
    
    "High Creatinine = Yes",
    "High Creatinine = No",
    "High Creatinine = Missing")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position")) %>% 
  
  pack_rows("Severe features (any)", 1, 3, label_row_css = "color: steelblue;") %>%
 #   pack_rows("Severe features only^a^", 4, 6, label_row_css = "color: steelblue;") %>% #^a^Missing when cHTN or gHTN or PE is missing.
  pack_rows("Severely high BP >=20 weeks gestation", 4, 6, label_row_css = "color: steelblue;") %>%
  pack_rows("Severe anemia (Hb <7g/dl)", 7,9, label_row_css = "color: steelblue;") %>%
  pack_rows("Bilirubin >=20.52", 10, 12, label_row_css = "color: steelblue;") %>%
  pack_rows("AST >=90", 13, 15, label_row_css = "color: steelblue;") %>%
  pack_rows("ALT >=120", 16, 18, label_row_css = "color: steelblue;") %>%
  pack_rows("Platelets <100,000", 19, 21, label_row_css = "color: steelblue;") %>%
  pack_rows("Creatinine >97.26", 22, 24, label_row_css = "color: steelblue;") 

```
<br>

\newpage
### Preeclampsia Diagnosed (during L&D)
```{r}
chtn_table <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    # PE DIAGNOSED:
     "PE Diagnosed = Yes " =
      paste0(sum(MAT_PE_DIAG == 1, na.rm = TRUE),
             " (",
             format(round(sum(MAT_PE_DIAG == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
        "PE Diagnosed = No " =
      paste0(sum(MAT_PE_DIAG == 0, na.rm = TRUE),
             " (",
             format(round(sum(MAT_PE_DIAG == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    "PE Diagnosed = Missing " =
      paste0(sum(is.na(MAT_PE_DIAG)),
             " (",
             format(round(sum(is.na(MAT_PE_DIAG))/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    # # DIAGNOSED FEATURES:
    #      "PE Diagnosed severe features = Yes " =
    #   paste0(sum(MAT_PE_ADDITIONAL_FEAT_TYPE == 1, na.rm = TRUE),
    #          " (",
    #          format(round(sum(MAT_PE_DIAG == 1, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
    #          ")"),
    #     "PE Diagnosed = No " =
    #   paste0(sum(MAT_PE_DIAG == 0, na.rm = TRUE),
    #          " (",
    #          format(round(sum(MAT_PE_DIAG == 0, na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
    #          ")"),
    # "PE Diagnosed = Missing " =
    #   paste0(sum(is.na(MAT_PE_DIAG)),
    #          " (",
    #          format(round(sum(is.na(MAT_PE_DIAG))/n()*100,2), nsmall=2, digits=3),
    #          ")"),
    # 
    # MAT_PE_ADDITIONAL_FEAT_TYPE
    
    ) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
    
```

#### Table 2e. PE diagnosed during L&D*
```{r}
chtn_table  %>% 
  `rownames<-` (c(
    "PE Diagnosed = Yes ",
    "PE Diagnosed = No ",
    "PE Diagnosed = Missing ")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position"))# %>% 
  
 # pack_rows("Preeclampsia diagnosed during L&D", 1, 3, label_row_css = "color: steelblue;")

    
```
*Currently not included in primary outcome definition.
<br>

\newpage

### Hypertensive Disorders of Pregnancy 
**Chronic hypertension**
<br>
**Definition:**
<br>
<ul>
<li>SBP>=140 or DBP >=90 <20 weeks' gestation.</li>
</ul>

**Gestational hypertension**
<br>
**Definition:** 
<br>
<ul>
<li>SBP >=140 or DBP >=90 >=20 weeks' gestation among those without cHTN.</li>
</ul>

**Preeclampsia (PE)**
<br>
**Definition:**
<br>
<ul>
<li>SBP >=140 or DBP >=90 >=20 weeks' AND gestational proteinuria OR</li>
<li>SBP >=140 or DBP >=90 >=20 weeks' AND severe features OR</li>
<li>SBP >=140 or DBP >=90 <20 weeks' gestation AND gestational proteinuria OR</li>
<li>SBP >=140 or DBP >=90 <20 weeks' gestation AND severe features</li>
</ul>
<br>

```{r}
chtn_table <- df %>%
  rowwise() %>%
  group_by(SITE) %>%
  summarise(
    # HDP
            "Preeclampsia (PE)" =
      paste0(sum(HDP=="PE", na.rm = TRUE),
             " (",
             format(round(sum(HDP=="PE", na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
      
    "PE with severe features" =
      paste0(sum(HDP=="PE with severe features", na.rm = TRUE),
             " (",
             format(round(sum(HDP=="PE with severe features", na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    
        "PE superimposed on cHTN" =
      paste0(sum(HDP=="PE superimposed on cHTN", na.rm = TRUE),
             " (",
             format(round(sum(HDP=="PE superimposed on cHTN", na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
    "gHTN" =
      paste0(sum(HDP=="gHTN", na.rm = TRUE),
             " (",
             format(round(sum(HDP=="gHTN", na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
        "cHTN" =
      paste0(sum(HDP=="cHTN", na.rm = TRUE),
             " (",
             format(round(sum(HDP=="cHTN", na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
            "No HDP" =
      paste0(sum(HDP=="No HDP", na.rm = TRUE),
             " (",
             format(round(sum(HDP=="No HDP", na.rm = TRUE)/n()*100,2), nsmall=2, digits=3),
             ")"),
    
                "HDP Missing " =
      paste0(sum(is.na(HDP), na.rm = TRUE),
             " (",
             format(round(sum(is.na(HDP))/n()*100,2), nsmall=2, digits=3),
             ")")) %>%
  
  t() %>% as.data.frame() %>%
  `colnames<-`(c(.[1,])) %>%
  slice(-1)
  
```

#### **Table 3. Hypertensive Disorders of Pregnancy (HDP)**
```{r}
chtn_table  %>% 
  `rownames<-` (c(
    "Preeclampsia ",
    "Preeclampisa with severe features",
    "Preeclampsia superimposed on chronic hypertension",
    "Gestational hypertension",
    "Chronic Hypertension",
    "No HDP",
    "Missing HDP")) %>% 
    
     mutate_all(funs(str_replace(., "NaN", "0"))) %>% 
  kbl(caption = "", booktabs = TRUE) %>%
  kable_paper(bootstrap_options = "striped", 
              full_width = T, html_font = "Cambria", position = "left",
              latex_options = c("repeat_header", "HOLD_position")) 

```

